function [th21, th22, th31, th32] = MGD(d1, L, B)

L1 = L(1);
L2 = L(2);
L3 = L(3);

b1 = B(1);
b2 = B(2);

th31 = 2*atan((2*L1*b1 - 2*L2*b2 + 2*L3*b1 + 2*L2*d1 - (L1^2*(2*L1*b1 - (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) + (L2^2*(2*L1*b1 - (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) + (L3^2*(2*L1*b1 - (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) - (b1^2*(2*L1*b1 - (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) - (b2^2*(2*L1*b1 - (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) - (d1^2*(2*L1*b1 - (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) - (2*L1*b2*(2*L1*b1 - (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) + (2*L1*d1*(2*L1*b1 - (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) + (2*b2*d1*(2*L1*b1 - (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2))/(- L1^2 + L2^2 + 2*L2*b1 + L3^2 + 2*L3*b2 - 2*L3*d1 + b1^2 + b2^2 - 2*b2*d1 + d1^2));
 
 
th32 = 2*atan((2*L1*b1 - 2*L2*b2 + 2*L3*b1 + 2*L2*d1 - (L1^2*(2*L1*b1 + (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) + (L2^2*(2*L1*b1 + (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) + (L3^2*(2*L1*b1 + (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) - (b1^2*(2*L1*b1 + (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) - (b2^2*(2*L1*b1 + (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) - (d1^2*(2*L1*b1 + (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) - (2*L1*b2*(2*L1*b1 + (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) + (2*L1*d1*(2*L1*b1 + (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2) + (2*b2*d1*(2*L1*b1 + (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2)))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2))/(- L1^2 + L2^2 + 2*L2*b1 + L3^2 + 2*L3*b2 - 2*L3*d1 + b1^2 + b2^2 - 2*b2*d1 + d1^2));
 
 
th21 = -2*atan((2*L1*b1 - (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2));
 
 
th22 = -2*atan((2*L1*b1 + (- L1^4 + 2*L1^2*L2^2 + 2*L1^2*L3^2 + 2*L1^2*b1^2 + 2*L1^2*b2^2 - 4*L1^2*b2*d1 + 2*L1^2*d1^2 - L2^4 - 2*L2^2*L3^2 + 2*L2^2*b1^2 + 2*L2^2*b2^2 - 4*L2^2*b2*d1 + 2*L2^2*d1^2 - L3^4 + 2*L3^2*b1^2 + 2*L3^2*b2^2 - 4*L3^2*b2*d1 + 2*L3^2*d1^2 - b1^4 - 2*b1^2*b2^2 + 4*b1^2*b2*d1 - 2*b1^2*d1^2 - b2^4 + 4*b2^3*d1 - 6*b2^2*d1^2 + 4*b2*d1^3 - d1^4)^(1/2))/(L1^2 + 2*L1*b2 - 2*L1*d1 - L2^2 - L3^2 + b1^2 + b2^2 - 2*b2*d1 + d1^2));


